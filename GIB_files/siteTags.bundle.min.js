(()=>{"use strict";const e="Tag Manager: ",t=function(){let e=!1;try{const t=window;e=t&&t.debug||t.location&&(t.location.search||"").toLowerCase().indexOf("debug=")>-1}catch(e){}return e}();function n(n){t&&console&&console.error(`${e} ${n}`)}function o(e){let t=e;try{t=JSON.parse(e)}catch(e){n("Parse error in string"),n(e.message)}return t}function r(e){return o(JSON.stringify(e))}function i(e,t){return e&&"true"===e[t]}const c="_api/tag-manager/api/v1/tags/",a=`${c}sites/`,d=[".wix.com",".editorx.com"],s="22bef345-3c5b-4c18-b782-74d4085112ff",u="specs.tagManagerRenderTagByPageID",l="specs.tagManager.ReadLoadOnceFromTag";let f=[];const g=[],p=[],m=[];let w=[],h={};function b(){return m}function E(){return r(h)}function y(e){return Object.keys(e).filter((t=>!!e[t]&&-1===w.indexOf(t)))}function T(e){f=e}function A(){return r(f)}function I(e){g.push(e)}function v(){return r(g)}function x(e){p.push(e)}function P(){return r(p)}function N(){const e=document.currentScript;let t=!1;let n;if(e instanceof HTMLScriptElement&&m.forEach((o=>{!t&&o.tag.appInfo&&o.embeddedNodes.forEach((r=>{var i;t||r===e&&(n=(null==(i=o.tag)||null==(i=i.appInfo)?void 0:i.id)||"",t=!0)}))})),!n){const t=function(e){let t="Script not identified";if(e instanceof HTMLScriptElement){const{type:n,src:o}=e;t=`type: ${n||"No Type Found"} src: ${o||"No URL Found"}`}return t}(e),o=`App not found for script ${t}, errorId: 404C`;console.error(o),n=new Error(o)}return n}const O=!!document.documentMode;function C(e,t,n){let o;O?(o=document.createEvent("CustomEvent"),o.initCustomEvent(e,!0,!0,n)):o=new CustomEvent(e,{detail:n}),t&&t.dispatchEvent&&setTimeout((()=>{t.dispatchEvent(o)}),0)}const S={TAG_MANAGER_LOADED:"TagManagerLoaded",TAGS_LOADING:"LoadingTags",TAG_LOADED:"TagLoaded",TAG_LOAD_ERROR:"TagLoadError"};function L(e,t,o){const r=()=>{try{if("function"==typeof e)return e(t)}catch(e){n(e)}};return!0===o?setTimeout(r,0):r()}function M(e,t,n,o){return()=>{o(n),function(e){f=f.filter((t=>t.name!==e))}(n.name),C(e,window,{tagName:t,embed:r(n)})}}const R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",D=R.length;function $(e,t){const n=function(){let e="";for(let t=0;t<16;t++)e+=R.charAt(Math.floor(Math.random()*D));return e}(),o=function(e){return`(function(getAccessToken){\n    Object.defineProperty(globalThis, ${e}, {\n      value: getAccessToken,\n      enumerable: false,\n      configurable: true,\n      writable: true,\n    });\n  }(wixEmbedsAPI.getAccessTokenFunction())`}(n),r=function(e,t,n){return`import { injectAccessTokenFunction } from "${e}";\n  if(injectAccessTokenFunction){\n    injectAccessTokenFunction(${t});\n  } else {\n    console.error("AppId ${n} does not expose function correctly, error code: Client 404");\n  }`}(e,n,t),i=()=>{delete globalThis[id]};return{moduleScriptConfig:{node:{tag:"SCRIPT",attributes:{type:"module"},content:r},callbacks:{onload:function(){i(),this.parentNode.removeChild(this)},onerror:function(){i(),this.parentNode.removeChild(this)}}},helperScriptConfig:{tag:"SCRIPT",content:o}}}function _(e,t,n){let o;return e.nodeType===Node.TEXT_NODE?o=document.createTextNode(e.content):e.nodeType===Node.COMMENT_NODE?o=document.createComment(e.content):(o=document.createElement(e.tag),e&&e.attributes instanceof NamedNodeMap?Array.prototype.forEach.call(e.attributes,(e=>{j(o,e.name,e.value)})):"object"==typeof e.attributes&&Object.keys(e.attributes).forEach((t=>{void 0!==typeof e.attributes[t]&&j(o,t,e.attributes[t])})),"SCRIPT"===e.tag?o=function(e,t,n,o){void 0===t&&(t="");if(o&&"module"===e.getAttribute("type")&&"true"===e.getAttribute("accesstoken")){let r=e.src;!r&&t&&(r=k(t)),e=null;const{helperScriptConfig:i,moduleScriptConfig:c}=$(r,o),a=()=>{const e=_(c.node,c.callbacks,o);document.head.appendChild(e)};return _(i,{onload:a,onerror:null==n?void 0:n.onerror},o)}!function(e,t,n){void 0===t&&(t="");t&&(e.src=k(t));e.addEventListener("load",(function(){L(n&&n.onload,null)}),!1),e.addEventListener("error",(function(){L(n&&n.onerror,null)}),!1)}(e,t,n);return e}(o,e.content,t,n):e.children&&e.children.length>0&&e.children.forEach((e=>{const r=_(e,t,n);o.appendChild(r)}))),o}function j(e,t,n){e.setAttribute(t,n)}function k(e){const t=new Blob([e],{type:"text/javascript;charset=utf-8"});return URL.createObjectURL(t)}function G(e){const t=[],n=document.createElement("DIV");return n.innerHTML=e,Array.prototype.forEach.call(n.childNodes,(e=>{const n=H(e);t.push(n)})),t}function H(e){const t=e.nodeType,n=e.innerHTML||e.textContent||e.nodeValue,o=[];return e.hasChildNodes()&&Array.prototype.forEach.call(e.childNodes,(e=>{o.push(H(e))})),{nodeType:t,tag:e.nodeName,attributes:e.attributes,content:n,children:o}}let U=function(e){return e.HEAD="head",e.BODY_START="bodyStart",e.BODY_END="bodyEnd",e}({});const B=e=>!e.id,F=e=>{var t;return!(null!=(t=e.tag)&&null!=(t=t.pages)&&t.length)},q=(e,t)=>{var n;return(null==(n=e.tag)||null==(n=n.pages)?void 0:n.includes(t.id||""))||!1};function J(e,t){return e.filter((e=>function(e,t){return B(t)||F(e)||q(e,t)}(e,t)))}function Y(e,t,n){const o=e.filter((e=>!e.embeddedNodes)),r=i(n,u)?J(o,t):o,c=r.map((e=>e.tag));T(c),C(S.TAGS_LOADING,window,c),r.forEach((e=>{var t;const n=null==(t=e.tag.appInfo)?void 0:t.id;e.embeddedNodes=e.embeddedNodes||[];const o=e.tag,r=G(o.content),i=o.position&&o.position!==U.HEAD?document.body:document.head;!function(e,t,n,o,r,i){let c=0;const a=()=>{c-=1,c>=0&&L(t.onload,{})},d=()=>{c-=1,c>=0&&L(t.onerror,{error:!0})},s=n.firstChild;e.forEach((e=>{"SCRIPT"===e.tag&&(c+=1);const t=_(e,{onload:a,onerror:d},i);r.push(t),o?n.insertBefore(t,s):n.appendChild(t)})),0===c&&L(t.onload,{},!0)}(r,{onload:M(S.TAG_LOADED,o.name,o,I),onerror:M(S.TAG_LOAD_ERROR,o.name,o,x)},i,o.position===U.BODY_START,e.embeddedNodes,n)}))}function z(e,t,n,o){const r=o&&o.headers||{},i=o&&o.query||{};r["content-type"]=r["content-type"]||"application/json";const c=new XMLHttpRequest,a=o&&o.postBody?"POST":"GET",d=`${e}${function(e){let t="";"object"==typeof e&&Object.keys(e).forEach((n=>{if(void 0!==e[n]){const o=encodeURIComponent(e[n]);t+=`${encodeURIComponent(n)}=${o}&`}}));return t=t?t.substr(0,t.length-1):"",t?`?${t}`:""}(i)}`;c.open(a,d,!0),c.onreadystatechange=()=>{if(4===c.readyState){const e=c.status;e<200||e>=300?L(n,{status:e,responseText:c.responseText}):L(t,c.responseText)}},Object.keys(r).forEach((e=>{void 0!==r[e]&&c.setRequestHeader(e,r[e])})),c.send(o&&o.postBody||null)}function V(e,t){void 0===t&&(t=location.search);let n=t.split(`${e}=`)[1];return n=n?decodeURIComponent(n.split("&")[0]):void 0,n}function W(e,t){const r=o(e),{currentPageID:c,initConsentPolicyManager:a=!1}=t;var d,s,u,f;if(r.errors&&r.errors.length>0&&n(JSON.stringify(r.errors)),r.config&&((s=r.config.consentPolicy)&&"object"==typeof s&&(w=[...w,...y(s)]),a&&window.consentPolicyManager&&window.consentPolicyManager.init({consentPolicy:r.config.consentPolicy}),"object"!=typeof(d=r.config)||Array.isArray(d)||(h={...h,...d})),r.tags){u=r.tags,i(null==(f=h)?void 0:f.experiments,l)?u.forEach((e=>{var t;const n=e.loadOnce||(null==(t=e.content)?void 0:t.includes('load-once="true"'));m.push({tag:{...e,loadOnce:n},embeddedNodes:null})})):u.forEach((e=>{m.push({tag:e,embeddedNodes:null})}));const e={id:c};Y(b(),e,r.config.experiments||{})}}const X=()=>"partytown"in window;function K(e,t,n){return`${e&&!function(e){let t=!1;return d.forEach((e=>{t||(t=location.hostname.indexOf(e)>0)})),t||e}(!!n)?e:""}/${a}${t}`}function Q(e){const{metasiteId:t,htmlsiteId:o,baseUrl:r,wixSite:i,language:c,categories:a}=e,d=V("site-override"),u=V("apps-override"),l=K(r,t,i),f=!i&&window.consentPolicyManager?window.consentPolicyManager._getConsentPolicyHeader():{},g=function(e){return e.wixEmbedsAPI.getCurrentPageInfo&&"function"==typeof e.wixEmbedsAPI.getCurrentPageInfo&&e.wixEmbedsAPI.getCurrentPageInfo()||{}}(window),p=V("omit"),m=window.wixEmbedsAPI.getAppToken;m&&(f.authorization=L(m,s)),z(l,(e=>{W(e,{initConsentPolicyManager:!a&&!!i,currentPageID:g.id})}),(e=>{n(`Error loading site tags at ${l}`),n(e.message)}),{query:{wixSite:!!i,htmlsiteId:o,language:c,categories:a,omit:p,partytown:X(),siteOverrideId:d,appsOverrideId:u},headers:f})}function Z(e){b().forEach((e=>{e.tag.loadOnce||(e.embeddedNodes&&e.embeddedNodes.forEach((e=>{L((()=>{e.parentNode.removeChild(e)}))})),e.embeddedNodes=null)}));Y(b(),e,E().experiments||{})}function ee(e){if(e&&e.detail&&e.detail.policy){const t=y(e.detail.policy);t.length&&Q({baseUrl:window.wixEmbedsAPI.getExternalBaseUrl(),htmlsiteId:window.wixEmbedsAPI.getHtmlSiteId(),metasiteId:window.wixEmbedsAPI.getMetaSiteId(),wixSite:window.wixEmbedsAPI.isWixSite(),language:window.wixEmbedsAPI.getLanguage(),categories:t})}}let te=()=>{const e=window.wixEmbedsAPI;Q({baseUrl:e.getExternalBaseUrl(),htmlsiteId:e.getHtmlSiteId(),metasiteId:e.getMetaSiteId(),language:e.getLanguage(),wixSite:e.isWixSite()}),window.wixEmbedsAPI.registerToEvent("pageNavigation",Z),document.addEventListener("consentPolicyChanged",ee),function(){const e=Object.freeze({getLoadedTags:v,getLoadingTags:A,getLoadErrorTags:P,getConfig:E,getAppId:N});Object.defineProperty(window,"wixTagManager",{value:e,writable:!1,configurable:!1,enumerable:!0}),C(S.TAG_MANAGER_LOADED,window,window.wixTagManager)}()};window.wixEmbedsAPI&&"function"==typeof window.wixEmbedsAPI.registerToEvent?te():window.addEventListener("wixEmbedsAPIReady",(()=>{te(),te=function(){}}),!1)})();
//# sourceMappingURL=siteTags.bundle.min.js.map